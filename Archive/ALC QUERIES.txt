PIM CLASS
Select C.CUST_NBR As "cust_nbr", C.CUST_NM As "cust_nm", C.PYR_SEG_DESC As "Pyramid.Segment.Desc.", C.CUST_ACCTBLTY_FLG As "Accountablity", C.SMPLFD_MENU_DESC As "Simplified Menu Type", PIM.PIM_CLS_DESC As "PIM Class Desc", C.PRNT_MLT_UNIT_DESC As "Parent multi unit", C.ZIP_CD As "zip code", D.RGN_NM As "Region.Name", D.DIV_NM As "Division.Name", D.AREA_NM As "Zone.Name", Sum(S.QTY_SHIP) As "Quantity.Shipped.SUM", Sum(Case When P.PROD_BRND = 'EB' Then S.QTY_SHIP Else 0 End) As "EB Cases", Sum(S.NET_WT_SHIP) As "Net.Weight.Shipped.SUM", Sum(S.GRS_SLS_EXTND) As "Gross.Sales.Extended.SUM", Sum(S.GRS_SLS_EXTND - S.DWA_COST_EXTND + (S.TTL_VNDR_FND_DVT)) As "Gross.TGP.SUM", Sum(S.TTL_ALWNC) As "Total.Allowance.SUM", Sum(S.TTL_VNDR_FND_DVT) As "Total Vendor Funded deviations", Sum(S.TTL_INT_VNDR_FND_DVT) As "Total Internal Funded deviations", Sum(S.ACTL_GP) As TAGP, C.CITY As "City", C.ST As "State", C.ADDR_LN_1 As "Address 1", C.ADDR_LN_2 As "Address 2", C.PHN_NBR As "Phone Number", D.BRNCH_CD From GOLD.XDMADM.SALES_CORP S, GOLD.XDMADM.CUST_CORP C, GOLD.XDMADM.DIV_CORP D, GOLD.XDMADM.PIM_CORP PIM, GOLD.XDMADM.PROD_CORP P, GOLD.XDMADM.TIME_CORP T, GOLD.XDMADM.DIV_CORP DA Where C.CUST_NBR = S.CUST_NBR And C.DIV_NBR = S.DIV_NBR And (D.DIV_NBR = S.DIV_NBR) And (PIM.PIM_USF_STD_PROD_CD = S.PIM_USF_STD_PROD_CD) And P.PROD_NBR = S.PROD_NBR And P.DIV_NBR = S.DIV_NBR And (T.CLNDR_DT = S.PRCS_DT) And DA.DIV_NBR = S.SLS_REVENUE_DIV_NBR And C.PYR_SEG_DESC = 'INDEPENDENT RESTAURATEURS' And C.CUST_ACCTBLTY_FLG = 'L' And PIM.PIM_CLS_DESC != 'BEEF' And D.RGN_NM In ('MIDWEST', 'NORTHEAST', 'SOUTH', 'SOUTHEAST', 'WEST') And S.ORD_SRC <> 'ST' And PIM.PIM_SUPRCLS_ID <> 97 And C.TRD_CLS = '1' And S.PRCS_DT Between '02-APR-2017' And '31-MAR-2018' And DA.ACQSTN_CMPNY_NM In ('USF', 'CARADONNA', 'DIERKS', 'JERACI') And S.XFER_TO_DT Is Null And D.DIV_TYP_CD = 'USF' Group By C.CUST_NBR, C.CUST_NM, C.PYR_SEG_DESC, C.CUST_ACCTBLTY_FLG, C.SMPLFD_MENU_DESC, PIM.PIM_CLS_DESC, C.PRNT_MLT_UNIT_DESC, C.ZIP_CD, D.RGN_NM, D.DIV_NM, D.AREA_NM, C.CITY, C.ST, C.ADDR_LN_1, C.ADDR_LN_2, C.PHN_NBR, D.BRNCH_CD

PIM CATEGORY BEEF
Select C.CUST_NBR As "cust_nbr", C.CUST_NM As "cust_nm", C.PYR_SEG_DESC As "Pyramid.Segment.Desc.", C.CUST_ACCTBLTY_FLG As "Accountablity", C.SMPLFD_MENU_DESC As "Simplified Menu Type", PIM.PIM_CLS_DESC As "PIM Class Desc", C.PRNT_MLT_UNIT_DESC As "Parent multi unit", C.ZIP_CD As "zip code", D.RGN_NM As "Region.Name", D.DIV_NM As "Division.Name", D.AREA_NM As "Zone.Name", Sum(S.QTY_SHIP) As "Quantity.Shipped.SUM", Sum(Case When P.PROD_BRND = 'EB' Then S.QTY_SHIP Else 0 End) As "EB Cases", Sum(S.NET_WT_SHIP) As "Net.Weight.Shipped.SUM", Sum(S.GRS_SLS_EXTND) As "Gross.Sales.Extended.SUM", Sum(S.GRS_SLS_EXTND - S.DWA_COST_EXTND + (S.TTL_VNDR_FND_DVT)) As "Gross.TGP.SUM", Sum(S.TTL_ALWNC) As "Total.Allowance.SUM", Sum(S.TTL_VNDR_FND_DVT) As "Total Vendor Funded deviations", Sum(S.TTL_INT_VNDR_FND_DVT) As "Total Internal Funded deviations", Sum(S.ACTL_GP) As TAGP, C.CITY As "City", C.ST As "State", C.ADDR_LN_1 As "Address 1", C.ADDR_LN_2 As "Address 2", C.PHN_NBR As "Phone Number", PIM.PIM_CTGRY_DESC, D.BRNCH_CD 
From GOLD.XDMADM.SALES_CORP S, GOLD.XDMADM.CUST_CORP C, GOLD.XDMADM.DIV_CORP D, GOLD.XDMADM.PIM_CORP PIM, GOLD.XDMADM.PROD_CORP P, GOLD.XDMADM.TIME_CORP T, GOLD.XDMADM.DIV_CORP DA Where C.CUST_NBR = S.CUST_NBR And C.DIV_NBR = S.DIV_NBR And (D.DIV_NBR = S.DIV_NBR) And (PIM.PIM_USF_STD_PROD_CD = S.PIM_USF_STD_PROD_CD) And P.PROD_NBR = S.PROD_NBR And P.DIV_NBR = S.DIV_NBR And (T.CLNDR_DT = S.PRCS_DT) And DA.DIV_NBR = S.SLS_REVENUE_DIV_NBR And C.PYR_SEG_DESC = 'INDEPENDENT RESTAURATEURS' And C.CUST_ACCTBLTY_FLG = 'L' And PIM.PIM_CLS_DESC = 'BEEF' And D.RGN_NM In ('MIDWEST', 'NORTHEAST', 'SOUTH', 'SOUTHEAST', 'WEST') And S.ORD_SRC <> 'ST' And PIM.PIM_SUPRCLS_ID <> 97 And C.TRD_CLS = '1' And S.PRCS_DT Between '02-APR-2017' And '31-MAR-2018' And DA.ACQSTN_CMPNY_NM In ('USF', 'CARADONNA', 'DIERKS', 'JERACI') And S.XFER_TO_DT Is Null And D.DIV_TYP_CD = 'USF' 
Group By C.CUST_NBR, C.CUST_NM, C.PYR_SEG_DESC, C.CUST_ACCTBLTY_FLG, C.SMPLFD_MENU_DESC, PIM.PIM_CLS_DESC, C.PRNT_MLT_UNIT_DESC, C.ZIP_CD, D.RGN_NM, D.DIV_NM, D.AREA_NM, C.CITY, C.ST, C.ADDR_LN_1, C.ADDR_LN_2, C.PHN_NBR, PIM.PIM_CTGRY_DESC, D.BRNCH_CD

CUSTOMER PROFIT MODEL / DELIVERY OUTPUT
Select * from BUSINESS_ANALYTICS.ANALYTICS.CUSTOMER_PROFIT_MODEL



Revised ALC PIM CLASS

--PIM CLASS
Select C.CUST_NBR As "cust_nbr", C.CUST_NM As "cust_nm", C.PYR_SEG_DESC As "Pyramid.Segment.Desc.", C.CUST_ACCTBLTY_FLG As "Accountablity", C.SMPLFD_MENU_DESC As "Simplified Menu Type", 
PIM.PIM_CLS_DESC As "PIM Class Desc", C.PRNT_MLT_UNIT_DESC As "Parent multi unit", C.ZIP_CD As "zip code", D.RGN_NM As "Region.Name", 
D.DIV_NM As "Division.Name", D.AREA_NM As "Zone.Name", 
Sum(S.QTY_SHIP) As "Quantity.Shipped.SUM", 
Sum(Case When P.PROD_BRND = 'EB' Then S.QTY_SHIP Else 0 End) As "EB Cases", 
Sum(S.NET_WT_SHIP) As "Net.Weight.Shipped.SUM", 
Sum(S.GRS_SLS_EXTND) As "Gross.Sales.Extended.SUM", 
Sum(S.GRS_SLS_EXTND - S.DWA_COST_EXTND + (S.TTL_VNDR_FND_DVT)) As "Gross.TGP.SUM", 
Sum(S.TTL_ALWNC) As "Total.Allowance.SUM", Sum(S.TTL_VNDR_FND_DVT) As "Total Vendor Funded deviations", Sum(S.TTL_INT_VNDR_FND_DVT) As "Total Internal Funded deviations", 
Sum(S.ACTL_GP) As TAGP, C.CITY As "City", C.ST As "State", C.ADDR_LN_1 As "Address 1", C.ADDR_LN_2 As "Address 2", C.PHN_NBR As "Phone Number", D.BRNCH_CD 
From GOLD.XDMADM.SALES_CORP S, GOLD.XDMADM.CUST_CORP C, GOLD.XDMADM.DIV_CORP D, GOLD.XDMADM.PIM_CORP PIM, GOLD.XDMADM.PROD_CORP P, GOLD.XDMADM.TIME_CORP T, GOLD.XDMADM.DIV_CORP DA 
Where C.CUST_NBR = S.CUST_NBR And C.DIV_NBR = S.DIV_NBR And (D.DIV_NBR = S.DIV_NBR) And (PIM.PIM_USF_STD_PROD_CD = S.PIM_USF_STD_PROD_CD) 
And P.PROD_NBR = S.PROD_NBR And P.DIV_NBR = S.DIV_NBR And (T.CLNDR_DT = S.PRCS_DT) And DA.DIV_NBR = S.SLS_REVENUE_DIV_NBR 
And C.PYR_SEG_DESC = 'INDEPENDENT RESTAURATEURS' And C.CUST_ACCTBLTY_FLG = 'L' And PIM.PIM_CLS_DESC != 'BEEF' And D.RGN_NM In ('MIDWEST', 'NORTHEAST', 'SOUTH', 'SOUTHEAST', 'WEST') And S.ORD_SRC <> 'ST' 
And PIM.PIM_SUPRCLS_ID <> 97 And C.TRD_CLS = '1' 
And S.PRCS_DT Between '02-APR-2017' And '31-MAR-2018' And DA.ACQSTN_CMPNY_NM In ('USF', 'CARADONNA', 'DIERKS', 'JERACI') 
And S.XFER_TO_DT Is Null 
And D.DIV_TYP_CD = 'USF' 
Group By C.CUST_NBR, C.CUST_NM, C.PYR_SEG_DESC, C.CUST_ACCTBLTY_FLG, C.SMPLFD_MENU_DESC, PIM.PIM_CLS_DESC, C.PRNT_MLT_UNIT_DESC, 
C.ZIP_CD, D.RGN_NM, D.DIV_NM, D.AREA_NM, C.CITY, C.ST, C.ADDR_LN_1, C.ADDR_LN_2, C.PHN_NBR, D.BRNCH_CD


